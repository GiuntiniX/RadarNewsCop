<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Radar de Not√≠cias</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #121212;
      color: #f0f0f0;
      margin: 0;
      padding: 0;
    }
    header {
      background: #1e1e1e;
      color: white;
      padding: 1em;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .titulo-radar {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5em;
      font-size: 1.5em;
    }
    .titulo-radar img {
      width: 32px;
      height: 32px;
      vertical-align: middle;
    }
    nav, .busca {
      text-align: center;
      margin: 1em 0;
      flex-wrap: wrap;
    }
    nav button, .busca button {
      margin: 5px;
      padding: 0.5em 1em;
      background: #00aced;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      outline: none;
    }
    nav button.active {
      background: #0077a3;
      font-weight: bold;
    }
    nav button:hover, .busca button:hover {
      background: #0077a3;
    }
    .busca input {
      padding: 0.5em;
      width: 200px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .contador {
      text-align: center;
      font-weight: bold;
      margin: 1em 0;
    }
    #noticias {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1em;
      padding: 1em;
    }
    .card {
      background: #ffffff;
      color: #000000;
      padding: 1em;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(255,255,255,0.1);
    }
    .card h3 {
      margin: 0.5em 0;
    }
    .card p {
      color: #333;
    }
    @media (max-width: 600px) {
      nav button, .busca button {
        width: 90%;
        margin: 5px auto;
        display: block;
      }
      .busca input {
        width: 90%;
      }
      #noticias {
        grid-template-columns: 1fr;
      }
      .titulo-radar {
        font-size: 1.1em;
      }
      .titulo-radar img {
        width: 24px;
        height: 24px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="titulo-radar">
      <img src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/1f6f0.png" alt="Radar Icon" />
      <span>Radar de Not√≠cias</span>
    </div>
    <nav id="editorias"></nav>
    <div class="busca">
      <input type="text" id="termoBusca" placeholder="Buscar por palavra-chave">
      <button onclick="buscarPorPalavra()">Buscar</button>
    </div>
    <div class="contador" id="contador"></div>
  </header>
  <main id="noticias"></main>
  <script>
const feeds = [
  { nome: 'Geral', url: 'https://news.google.com/rss?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Mundo', url: 'https://news.google.com/rss/headlines/section/topic/WORLD.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Pol√≠tica', url: 'https://news.google.com/rss/headlines/section/topic/POLITICS.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Neg√≥cios', url: 'https://news.google.com/rss/headlines/section/topic/BUSINESS.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Ci√™ncia', url: 'https://news.google.com/rss/headlines/section/topic/SCIENCE.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Sa√∫de', url: 'https://news.google.com/rss/headlines/section/topic/HEALTH.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Tecnologia', url: 'https://news.google.com/rss/headlines/section/topic/TECHNOLOGY.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Esportes', url: 'https://news.google.com/rss/headlines/section/topic/SPORTS.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Entretenimento', url: 'https://news.google.com/rss/headlines/section/topic/ENTERTAINMENT.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Brasil', url: 'https://news.google.com/rss/headlines/section/geo/Brasil?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Economia', url: 'https://news.google.com/rss/search?q=economia&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Educa√ß√£o', url: 'https://news.google.com/rss/search?q=educa√ß√£o&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Carreira', url: 'https://news.google.com/rss/search?q=carreira&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Meio Ambiente', url: 'https://news.google.com/rss/search?q=meio+ambiente&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Arte', url: 'https://news.google.com/rss/search?q=arte&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Opini√£o', url: 'https://news.google.com/rss/search?q=opini√£o&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Moda', url: 'https://news.google.com/rss/search?q=moda&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Culin√°ria', url: 'https://news.google.com/rss/search?q=culin√°ria&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Turismo', url: 'https://news.google.com/rss/search?q=turismo&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Religi√£o', url: 'https://news.google.com/rss/search?q=religi√£o&hl=pt-BR&gl=BR&ceid=BR:pt-419' }
];

let noticiasAtuais = [];
let editoriaAtual = 0;

function atualizarContador(qtd) {
  document.getElementById("contador").textContent = `üî¢ Total de not√≠cias exibidas: ${qtd}`;
}

function formatarDataAMPM(dataStr) {
  if (!dataStr) return "";
  const data = new Date(dataStr);
  if (isNaN(data)) return "";
  // Formato: 23/09/2025, 10:15 AM
  return data.toLocaleString('pt-BR', {
    day: '2-digit', month: '2-digit', year: 'numeric',
    hour: '2-digit', minute: '2-digit', hour12: true
  }).replace(',', ' -');
}

function exibirNoticias(lista) {
  const noticias = document.getElementById("noticias");
  noticias.innerHTML = "";
  if (!lista.length) {
    noticias.innerHTML = "<p>Nenhuma not√≠cia encontrada.</p>";
    atualizarContador(0);
    return;
  }
  lista.forEach(item => {
    try {
      const title = item.querySelector("title").textContent;
      const link = item.querySelector("link").textContent;
      const description = item.querySelector("description")?.textContent || "";
      const pubDate = item.querySelector("pubDate")?.textContent || "";

      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <h3><a href="${link}" target="_blank">${title}</a></h3>
        <small style="color:#666;">${pubDate ? ('üïí ' + formatarDataAMPM(pubDate)) : ''}</small>
        <p>${description}</p>
      `;
      noticias.appendChild(card);
    } catch (e) {}
  });
  atualizarContador(lista.length);
}

function carregarEditoriasNav() {
  const nav = document.getElementById('editorias');
  feeds.forEach((feed, idx) => {
    const btn = document.createElement('button');
    btn.textContent = feed.nome;
    btn.onclick = () => selecionarEditoria(idx);
    btn.id = "btn-edit-" + idx;
    if (idx === 0) btn.className = "active";
    nav.appendChild(btn);
  });
}

function selecionarEditoria(idx) {
  editoriaAtual = idx;
  // Atualiza estado visual
  feeds.forEach((_, i) => {
    const btn = document.getElementById("btn-edit-" + i);
    if (btn) btn.classList.toggle("active", i === idx);
  });
  carregarEditorias(idx);
}

function carregarEditorias(idx) {
  const rssUrl = feeds[idx].url;
  const noticias = document.getElementById("noticias");
  noticias.innerHTML = "<p>Carregando not√≠cias...</p>";
  atualizarContador(0);

  // Para a editoria "Geral", buscar mat√©rias de hoje e de ontem e somar
  if (feeds[idx].nome === "Geral") {
    buscarNoticiasHojeOntem(rssUrl);
    return;
  }
  fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(rssUrl)}`)
    .then(response => response.json())
    .then(data => {
      const parser = new DOMParser();
      const xml = parser.parseFromString(data.contents, "application/xml");
      noticiasAtuais = Array.from(xml.querySelectorAll("item"));
      exibirNoticias(noticiasAtuais);
    })
    .catch(err => {
      noticias.innerHTML = `<p>Erro ao carregar not√≠cias: ${err.message}</p>`;
    });
}

function buscarNoticiasHojeOntem(rssUrl) {
  const noticias = document.getElementById("noticias");
  noticias.innerHTML = "<p>Carregando not√≠cias de hoje e de ontem...</p>";
  atualizarContador(0);

  fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(rssUrl)}`)
    .then(response => response.json())
    .then(data => {
      const parser = new DOMParser();
      const xml = parser.parseFromString(data.contents, "application/xml");
      let items = Array.from(xml.querySelectorAll("item"));

      // Filtrar principais de hoje e de ontem
      const hoje = new Date();
      hoje.setHours(0,0,0,0);
      const ontem = new Date(hoje);
      ontem.setDate(hoje.getDate() - 1);

      // Pega as not√≠cias do feed que t√™m pubDate de hoje ou ontem
      const noticiasFiltradas = items.filter(item => {
        const pubDate = item.querySelector("pubDate")?.textContent;
        if (!pubDate) return false;
        const dataNoticia = new Date(pubDate);
        if (isNaN(dataNoticia)) return false;
        dataNoticia.setHours(0,0,0,0);
        return (dataNoticia.getTime() === hoje.getTime() || dataNoticia.getTime() === ontem.getTime());
      });

      // Se n√£o encontrou, mostra todas normalmente
      noticiasAtuais = noticiasFiltradas.length ? noticiasFiltradas : items;
      exibirNoticias(noticiasAtuais);
    })
    .catch(err => {
      noticias.innerHTML = `<p>Erro ao carregar not√≠cias: ${err.message}</p>`;
    });
}

function buscarPorPalavra() {
  const termo = document.getElementById("termoBusca").value.trim();
  if (!termo) return;
  const rssBusca = `https://news.google.com/rss/search?q=${encodeURIComponent(termo)}&hl=pt-BR&gl=BR&ceid=BR:pt-419`;
  const noticias = document.getElementById("noticias");
  noticias.innerHTML = "<p>Buscando not√≠cias...</p>";
  atualizarContador(0);

  fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(rssBusca)}`)
    .then(response => response.json())
    .then(data => {
      const parser = new DOMParser();
      const xml = parser.parseFromString(data.contents, "application/xml");
      noticiasAtuais = Array.from(xml.querySelectorAll("item"));
      exibirNoticias(noticiasAtuais);
    })
    .catch(err => {
      noticias.innerHTML = `<p>Erro ao buscar not√≠cias: ${err.message}</p>`;
    });
}

// Inicializa√ß√£o
window.onload = () => {
  carregarEditoriasNav();
  selecionarEditoria(0); // Geral selecionado e carregado ao abrir
};
</script>
</body>
</html>
