<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <title>Radar de Not√≠cias ‚Äî Classifica√ß√£o Autom√°tica</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#0f1112;
      --panel:#151718;
      --muted:#9aa3a8;
      --accent:#00aced;
      --card:#ffffff;
      --card-text:#111;
      --gap:14px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;
      background:var(--bg);
      color:#e8eef0;
    }

    header{
      background:linear-gradient(180deg,#141619 0%,#111214 100%);
      border-bottom:1px solid rgba(255,255,255,0.03);
      padding:14px 16px;
      position:sticky;
      top:0;
      z-index:50;
    }
    .header-inner{
      max-width:1200px;
      margin:0 auto;
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .brand{display:flex;gap:12px;align-items:center}
    .brand img{width:36px;height:36px}
    .brand .title{font-weight:700;font-size:1.1rem;color:var(--accent)}
    .meta{color:var(--muted);font-size:0.88rem}
    .meta a{color:var(--accent);text-decoration:underline}

    /* Menu √∫nico apenas com editorias */
    .menu-area{
      max-width:1200px;
      margin:12px auto 0;
      padding:12px;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:center;
      flex-wrap:wrap;
      background:linear-gradient(90deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.02);
    }
    .editoria-btn{
      padding:8px 12px;
      border-radius:10px;
      border:0;
      cursor:pointer;
      color:#fff;
      font-weight:700;
      background:linear-gradient(90deg,var(--accent),#48d6ff);
      box-shadow:0 6px 16px rgba(0,172,237,0.08);
      transition:transform .12s ease, box-shadow .12s ease, opacity .12s;
    }
    .editoria-btn[disabled]{ opacity:0.5; cursor:not-allowed; box-shadow:none }
    .editoria-btn.active{ box-shadow:0 10px 30px rgba(0,172,237,0.18) }

    /* Actions */
    .actions{
      max-width:1200px;
      margin:14px auto;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:center;
      flex-wrap:wrap;
    }
    .actions input{ padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;min-width:260px }
    .actions .btn{ padding:8px 12px;border-radius:8px;border:0;background:var(--accent);color:#041114;font-weight:700; cursor:pointer }
    .timer{ color:var(--muted); font-size:0.92rem }

    /* Layout */
    .container{
      max-width:1200px;
      margin:20px auto 60px;
      display:grid;
      grid-template-columns: 1fr 320px;
      gap:18px;
      align-items:start;
    }
    .main{ min-height:300px }

    /* Cards grid: 2 por linha */
    .cards-grid{
      display:grid;
      grid-template-columns: repeat(2,1fr);
      gap:var(--gap);
    }
    .card{
      background:var(--card);
      color:var(--card-text);
      padding:12px 14px;
      border-radius:10px;
      box-shadow:0 6px 18px rgba(0,0,0,0.45);
      border-left:6px solid var(--accent);
      display:flex;
      flex-direction:column;
      min-height:130px;
    }
    .card h3{margin:0 0 6px;font-size:1rem}
    .card p{margin:0 0 8px;color:#333;flex:1;font-size:0.95rem}
    .card small{color:#666;display:block;margin-bottom:6px}
    .meta-row{display:flex;justify-content:space-between;align-items:center;gap:8px}
    .source-pill{background:rgba(0,0,0,0.03);padding:6px 8px;border-radius:999px;font-size:0.85rem;color:#444}
    .editoria-pill{background:#00aced;color:#041114;padding:6px 8px;border-radius:8px;font-weight:700;font-size:0.82rem}

    /* sidebar */
    .sidebar{ position:relative }
    .sidebar h4{color:var(--accent); text-align:center; margin:0 0 8px}
    .sidebar .item{ background:var(--panel); border-radius:8px; padding:10px; margin-bottom:10px; color:var(--muted); border-left:4px solid rgba(255,255,255,0.03) }
    .sidebar .item a{ color:#9be9ff; text-decoration:underline; font-weight:600 }

    #contador-hoje{ color:var(--muted); text-align:center; margin-top:6px }

    @media (max-width:820px){ .container{ grid-template-columns:1fr } .cards-grid{ grid-template-columns:1fr } .sidebar{order:2} }
  </style>
</head>
<body>
  <header>
    <div class="header-inner">
      <div style="display:flex;gap:12px;align-items:center">
        <div class="brand">
          <img src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/1f6f0.png" alt="Radar" />
          <div>
            <div class="title">Radar de Not√≠cias</div>
            <div class="meta" style="font-size:0.82rem">Desenvolvido por <a href="mailto:guilherme.giuntini@telefonica.com">Guilherme Giuntini</a></div>
          </div>
        </div>
      </div>
      <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
        <div class="timer" id="refresh-timer">‚è≥ Atualiza√ß√£o autom√°tica em --:--</div>
        <button class="btn" id="btn-refresh" onclick="refreshNoticias()">üîÑ Atualizar agora</button>
      </div>
    </div>

    <!-- Menu √∫nico com editorias -->
    <div class="menu-area" id="menuArea" role="navigation" aria-label="Editorias principais"></div>

    <!-- A√ß√µes -->
    <div class="actions">
      <input id="termoBusca" type="text" placeholder="Buscar por palavra-chave (ex: elei√ß√µes, show, Copa do Mundo)" />
      <button class="btn" onclick="buscarPorPalavra()">Buscar</button>
    </div>

    <div style="max-width:1200px;margin:8px auto 0;text-align:center">
      <div id="contador-hoje">üî¢ Not√≠cias carregadas hoje: 0</div>
    </div>
  </header>

  <div class="container">
    <main class="main" id="noticias" aria-live="polite">
      <!-- cards-grid ser√° inserido aqui -->
    </main>

    <aside class="sidebar" aria-label="Mais publicadas">
      <h4>Mais publicadas (√∫ltimas 5h)</h4>
      <div id="mais-publicadas"></div>
    </aside>
  </div>

<script>
/*
  Implementa√ß√£o solicitada:
  - Removi subeditorias (painel de subcategorias).
  - Trago todas as not√≠cias (como antes): coleta ampla de feeds incluindo Google News *.
  - N√ÉO agrego artigos no feed principal: um card = uma mat√©ria.
  - Adicionei classifica√ß√£o autom√°tica "inteligente" que atribui cada not√≠cia a uma das editorias dispon√≠veis.
    Essa classifica√ß√£o √© por heur√≠stica de palavras-chaves (pontua√ß√£o por categoria) aplicada ao t√≠tulo+descri√ß√£o.
  - O menu principal continua mostrando editorias; ao clicar em uma editoria ser√° filtrada a lista j√° classificada,
    exibindo apenas as mat√©rias atribu√≠das a essa editoria. "Todas" mostra tudo.
  Observa√ß√£o: Este classificadora √© leve (client-side), funciona bem em grande parte dos casos. Se quiser, eu posso
  substituir por uma chamada a servi√ßo de NLP mais avan√ßado (API) para melhorar precis√£o.
*/

// Feeds: Google News geral (*) + editorias e buscas amplas
const feeds = [
  { nome: 'Tudo (GoogleNews *)', url: 'https://news.google.com/rss/search?q=*&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Principal (GoogleNews)', url: 'https://news.google.com/rss?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  // editorias / buscas mais amplas
  { nome: 'Geral', url: 'https://news.google.com/rss/headlines/section/topic/NATION.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Brasil', url: 'https://news.google.com/rss/headlines/section/geo/Brasil?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Mundo', url: 'https://news.google.com/rss/headlines/section/topic/WORLD.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Pol√≠tica', url: 'https://news.google.com/rss/headlines/section/topic/POLITICS.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Economia', url: 'https://news.google.com/rss/headlines/section/topic/BUSINESS.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Ci√™ncia', url: 'https://news.google.com/rss/headlines/section/topic/SCIENCE.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Sa√∫de', url: 'https://news.google.com/rss/headlines/section/topic/HEALTH.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Educa√ß√£o', url: 'https://news.google.com/rss/search?q=educa√ß√£o&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Meio Ambiente', url: 'https://news.google.com/rss/search?q=meio+ambiente&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Tecnologia', url: 'https://news.google.com/rss/headlines/section/topic/TECHNOLOGY.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Neg√≥cios', url: 'https://news.google.com/rss/search?q=neg√≥cios&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Cultura', url: 'https://news.google.com/rss/search?q=cultura&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Entretenimento', url: 'https://news.google.com/rss/headlines/section/topic/ENTERTAINMENT.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Arte', url: 'https://news.google.com/rss/search?q=arte&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Moda', url: 'https://news.google.com/rss/search?q=moda&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Culin√°ria', url: 'https://news.google.com/rss/search?q=culin√°ria&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Turismo', url: 'https://news.google.com/rss/search?q=turismo&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Religi√£o', url: 'https://news.google.com/rss/search?q=religi√£o&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Carreira', url: 'https://news.google.com/rss/search?q=carreira&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Opini√£o', url: 'https://news.google.com/rss/search?q=opini√£o&hl=pt-BR&gl=BR&ceid=BR:pt-419' },
  { nome: 'Esportes', url: 'https://news.google.com/rss/headlines/section/topic/SPORTS.pt_br?hl=pt-BR&gl=BR&ceid=BR:pt-419' }
];

// Lista de editorias que o sistema usar√° (menu)
const EDITORIAS = [
  'Todas','Geral','Brasil','Mundo','Pol√≠tica','Economia','Ci√™ncia','Sa√∫de',
  'Educa√ß√£o','Meio Ambiente','Tecnologia','Neg√≥cios','Cultura','Entretenimento',
  'Arte','Moda','Culin√°ria','Turismo','Religi√£o','Carreira','Opini√£o','Esportes'
];

// Palavras-chave por editoria (base da classifica√ß√£o autom√°tica).
// Quanto mais palavras por editoria, maior a chance de acerto.
// Voc√™ pode afinar/expandir essas listas conforme necess√°rio.
const KEYWORDS = {
  'Pol√≠tica': ['presidente','governo','ministro','parlamento','deputado','senador','congresso','elei√ß√£o','minist√©rio','pol√≠tica','secret√°rio'],
  'Economia': ['economia','bancos','juros','infla√ß√£o','ibge','c√¢mbio','bolsa','mercado','investimento','PIB','empresa','empresas','setor financeiro'],
  'Ci√™ncia': ['pesquisa','cient√≠fico','estudo','laborat√≥rio','cientistas','universidade','descoberta','cient√≠fica','estudo'],
  'Sa√∫de': ['sa√∫de','paciente','hospital','vacina','doutor','epidemia','pandemia','SUS','doen√ßa','cl√≠nico','m√©dico'],
  'Educa√ß√£o': ['escola','ensino','universidade','professor','aluno','vestibular','educa√ß√£o','ensino m√©dio','ensino b√°sico'],
  'Meio Ambiente': ['clima','meio ambiente','sustentabilidade','desmatamento','fauna','flora','desastre ambiental','emiss√µes'],
  'Tecnologia': ['tecnologia','app','aplicativo','intelig√™ncia artificial','ia','startup','software','hardware','gadgets','blockchain','criptomoeda'],
  'Neg√≥cios': ['empresa','neg√≥cios','fus√µes','aquisi√ß√£o','CEO','executivo','startup','investidor','contrato','finan√ßas'],
  'Cultura': ['cultura','evento cultural','festival','museu','exposi√ß√£o','cultural'],
  'Entretenimento': ['entretenimento','√°lbum','turn√™','filme','cinema','ator','atriz','estreia','entrevista','celebridade'],
  'Arte': ['arte','obra','exposi√ß√£o','galeria','pintura','escultura'],
  'Moda': ['moda','desfile','estilista','cole√ß√£o','tend√™ncia'],
  'Culin√°ria': ['culin√°ria','receita','chefe','restaurante','gastronomia','prato'],
  'Turismo': ['turismo','destino','hotel','viagem','roteiro','voo'],
  'Religi√£o': ['igreja','religi√£o','pastor','culto','f√©','obispo','evang√©lico','cat√≥lico'],
  'Carreira': ['carreira','emprego','vaga','sal√°rio','curr√≠culo','recrutamento'],
  'Opini√£o': ['opini√£o','coluna','editorial','artigo de opini√£o'],
  'Esportes': ['gol','jogo','partida','time','campeonato','futebol','basquete','nata√ß√£o','voleibol','f√≥rmula 1','F1','Copa']
};

// normaliza texto (remove acentos, lower)
function normalizeText(s){
  return s ? s.normalize('NFD').replace(/[\u0300-\u036f]/g,'').toLowerCase() : '';
}

// classifica√ß√£o autom√°tica: retorna a editoria com maior score (ou 'Geral' em caso de empate/score baixo)
function classifyArticle(title, description){
  const text = normalizeText((title || '') + ' ' + (description || ''));
  let best = 'Geral';
  let bestScore = 0;
  for(const [editoria, words] of Object.entries(KEYWORDS)){
    let score = 0;
    for(const w of words){
      // palavra simples ou express√£o
      const pattern = '\\b' + w.replace(/\s+/g,'\\s+') + '\\b';
      const re = new RegExp(pattern,'i');
      if(re.test(text)) score += 2; // ocorr√™ncia exata ganha 2 pontos
      // partial match
      if(text.includes(w)) score += 0.5;
    }
    if(score > bestScore){
      bestScore = score;
      best = editoria;
    }
  }
  // se score baixo (<1), manter 'Geral'
  if(bestScore < 1) return 'Geral';
  return best;
}

/* util: formata data */
function formatarDataAMPM(dataStr){
  if(!dataStr) return '';
  const d = new Date(dataStr);
  if(isNaN(d)) return '';
  return d.toLocaleString('pt-BR', {day:'2-digit',month:'2-digit',year:'numeric', hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:false}).replace(',', ' -');
}

/* util: identifica se data √© HOJE (local) */
function isDateToday(pubDateStr){
  if(!pubDateStr) return false;
  const d = new Date(pubDateStr);
  if(isNaN(d)) return false;
  const now = new Date();
  return d.getFullYear() === now.getFullYear() && d.getMonth() === now.getMonth() && d.getDate() === now.getDate();
}

/* fetch RSS via proxy */
async function fetchRss(url){
  try{
    const resp = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(url)}`);
    if(!resp.ok) throw new Error('proxy-fail');
    const data = await resp.json();
    const parser = new DOMParser();
    const xml = parser.parseFromString(data.contents, 'application/xml');
    const items = Array.from(xml.querySelectorAll('item'));
    return items;
  }catch(e){
    console.warn('Erro ao buscar feed', url, e);
    return [];
  }
}

/* Render menu de editorias */
function renderEditoriasMenu(){
  const menu = document.getElementById('menuArea');
  menu.innerHTML = '';
  EDITORIAS.forEach(name => {
    const btn = document.createElement('button');
    btn.className = 'editoria-btn';
    btn.textContent = name;
    btn.onclick = () => filterByEditoria(name);
    menu.appendChild(btn);
  });
}

/* estado global */
let noticiasAtuais = []; // array de objetos: {item (XML), editoria, title, link, desc, pubDate, source}
let editoriaAtiva = 'Todas';
let isLoading = false;

/* bloquear/desbloquear bot√µes enquanto carrega */
function setButtonsDisabled(disabled){
  const buttons = document.querySelectorAll('.editoria-btn');
  buttons.forEach(b => b.disabled = disabled);
  isLoading = disabled;
}

/* Exibir cards (um card por mat√©ria) em grid 2 colunas */
function renderCards(list){
  const main = document.getElementById('noticias');
  main.innerHTML = '';
  const grid = document.createElement('div');
  grid.className = 'cards-grid';
  let total = 0;
  list.forEach(a => {
    try{
      const card = document.createElement('article');
      card.className = 'card';
      card.innerHTML = `
        <h3><a href="${a.link}" target="_blank" rel="noopener noreferrer">${a.title}</a></h3>
        <small>üïí ${a.pubDate ? formatarDataAMPM(a.pubDate) : ''}</small>
        <p>${a.desc || ''}</p>
        <div class="meta-row">
          <div style="display:flex;gap:8px;align-items:center">
            <div class="source-pill">${a.source}</div>
            <div class="editoria-pill">${a.editoria}</div>
          </div>
          <div style="font-size:0.84rem;color:#888"></div>
        </div>`;
      grid.appendChild(card);
      total++;
    }catch(e){}
  });
  main.appendChild(grid);
  document.getElementById('contador-hoje').textContent = `üî¢ Not√≠cias carregadas hoje: ${total}`;
}

/* Atualiza sidebar "Mais publicadas (√∫ltimas 5h)" */
function atualizarMaisPublicadasFrom(list){
  const container = document.getElementById('mais-publicadas');
  container.innerHTML = '';
  if(!list || list.length === 0){
    container.innerHTML = `<div style="color:var(--muted)">Sem dados recentes.</div>`;
    return;
  }
  const agora = new Date();
  const cincoHoras = new Date(agora.getTime() - 5*60*60*1000);
  const map = {};
  list.forEach(a=>{
    try{
      const pub = new Date(a.pubDate || 0);
      if(isNaN(pub) || pub < cincoHoras) return;
      const key = a.title.toLowerCase().replace(/[^\w\s]/g,'').substring(0,180);
      if(!map[key]) map[key] = {count:0, item:a, latest:pub};
      map[key].count++;
      if(pub > map[key].latest) map[key].latest = pub;
    }catch(e){}
  });
  const arr = Object.values(map).sort((x,y)=> y.count - x.count || y.latest - x.latest).slice(0,12);
  if(arr.length === 0){
    container.innerHTML = `<div style="color:var(--muted)">Sem publica√ß√µes nas √∫ltimas 5 horas.</div>`;
    return;
  }
  arr.forEach(entry=>{
    const a = entry.item;
    const div = document.createElement('div');
    div.className = 'item';
    div.innerHTML = `<a href="${a.link}" target="_blank" rel="noopener noreferrer">${a.title}</a>
      <div style="margin-top:6px;color:var(--muted);font-size:0.88rem">üóû ${a.source} ‚Ä¢ ${formatarDataAMPM(a.pubDate)} ${entry.count>1?` ‚Ä¢ √ó${entry.count}`:''}</div>`;
    container.appendChild(div);
  });
}

/* Carrega todas as not√≠cias (todos os feeds), filtra para HOJE, classifica cada item */
async function carregarTodasHoje(){
  if(isLoading) return;
  setButtonsDisabled(true);
  editoriaAtiva = 'Todas';
  highlightActiveEditorias();
  document.getElementById('noticias').innerHTML = `<div style="color:var(--muted);padding:12px;border-radius:8px">Carregando todas not√≠cias de hoje...</div>`;
  let todos = [];
  const promises = feeds.map(f => fetchRss(f.url).then(items => {
    if(items && items.length) todos = todos.concat(items);
  }));
  await Promise.all(promises);
  // map para estrutura amig√°vel e filtrar hoje
  const mapped = todos.map(item => {
    const title = item.querySelector('title')?.textContent || '(sem t√≠tulo)';
    const link = item.querySelector('link')?.textContent || (item.querySelector('guid')?.textContent || '#');
    const desc = item.querySelector('description')?.textContent || '';
    const pubDate = item.querySelector('pubDate')?.textContent || '';
    const source = (() => { try { return new URL(link).hostname.replace('www.',''); } catch(e){ return ''; } })();
    return { item, title, link, desc, pubDate, source };
  }).filter(a => isDateToday(a.pubDate));
  // classificar cada item
  const classified = mapped.map(a => {
    const editoria = classifyArticle(a.title, a.desc);
    return { ...a, editoria };
  });
  // ordenar por data desc
  classified.sort((a,b)=> new Date(b.pubDate || 0) - new Date(a.pubDate || 0));
  noticiasAtuais = classified;
  renderCards(noticiasAtuais);
  atualizarMaisPublicadasFrom(noticiasAtuais);
  setButtonsDisabled(false);
}

/* Filtrar por editoria (usa classifica√ß√£o j√° feita) */
function filterByEditoria(name){
  if(isLoading) return;
  editoriaAtiva = name;
  highlightActiveEditorias();
  if(name === 'Todas'){
    renderCards(noticiasAtuais);
    atualizarMaisPublicadasFrom(noticiasAtuais);
    return;
  }
  const filtered = noticiasAtuais.filter(a => a.editoria === name);
  renderCards(filtered);
  atualizarMaisPublicadasFrom(filtered);
}

/* Marca bot√£o ativo visualmente */
function highlightActiveEditorias(){
  const buttons = document.querySelectorAll('.editoria-btn');
  buttons.forEach(b => {
    if(b.textContent === editoriaAtiva) b.classList.add('active');
    else b.classList.remove('active');
  });
}

/* Buscar por palavra (usa Google News search), filtrar para hoje, classificar */
async function buscarPorPalavra(){
  const termo = document.getElementById('termoBusca').value.trim();
  if(!termo){
    return carregarTodasHoje();
  }
  if(isLoading) return;
  setButtonsDisabled(true);
  document.getElementById('noticias').innerHTML = `<div style="color:var(--muted);padding:12px;border-radius:8px">Buscando "${termo}" em not√≠cias de hoje...</div>`;
  const rssBusca = `https://news.google.com/rss/search?q=${encodeURIComponent(termo)}&hl=pt-BR&gl=BR&ceid=BR:pt-419`;
  const items = await fetchRss(rssBusca);
  const mapped = items.map(item => {
    const title = item.querySelector('title')?.textContent || '(sem t√≠tulo)';
    const link = item.querySelector('link')?.textContent || '#';
    const desc = item.querySelector('description')?.textContent || '';
    const pubDate = item.querySelector('pubDate')?.textContent || '';
    const source = (() => { try { return new URL(link).hostname.replace('www.',''); } catch(e){ return ''; } })();
    return { item, title, link, desc, pubDate, source };
  }).filter(a => isDateToday(a.pubDate));
  const classified = mapped.map(a => ({ ...a, editoria: classifyArticle(a.title, a.desc) }));
  classified.sort((a,b)=> new Date(b.pubDate || 0) - new Date(a.pubDate || 0));
  noticiasAtuais = classified;
  editoriaAtiva = 'Todas';
  highlightActiveEditorias();
  renderCards(noticiasAtuais);
  atualizarMaisPublicadasFrom(noticiasAtuais);
  setButtonsDisabled(false);
}

/* Auto refresh (15min) e manual */
let refreshInterval = 15 * 60;
let refreshCountdown = refreshInterval;
let refreshTimerId = null;
function atualizarTimerRefresh(){
  const el = document.getElementById('refresh-timer');
  if(!el) return;
  const m = Math.floor(refreshCountdown/60).toString().padStart(2,'0');
  const s = (refreshCountdown%60).toString().padStart(2,'0');
  el.textContent = `‚è≥ Atualiza√ß√£o autom√°tica em ${m}:${s}`;
}
function iniciarAutoRefresh(){
  if(refreshTimerId) clearInterval(refreshTimerId);
  refreshCountdown = refreshInterval;
  atualizarTimerRefresh();
  refreshTimerId = setInterval(()=>{
    refreshCountdown--;
    if(refreshCountdown <= 0){
      refreshCountdown = refreshInterval;
      carregarTodasHoje();
    }
    atualizarTimerRefresh();
  }, 1000);
}
function refreshNoticias(){
  carregarTodasHoje();
  refreshCountdown = refreshInterval;
  atualizarTimerRefresh();
}

/* Inicializa√ß√£o */
function init(){
  renderEditoriasMenu();
  carregarTodasHoje();
  iniciarAutoRefresh();
}
init();

</script>
</body>
</html>
